# WikiArt t-SNE Embeddings and Parametric Model

In this repo I've provided a full set of t-SNE embeddings for the wikiart dataset + a parametric t-SNE Model trained on those embeddings. Feel free to use them for art or machine learning projects.

# Requirements

To use the prebuilt embeddings, you'll need the following wikiart dataset:

https://github.com/cs-chan/ArtGAN/blob/master/WikiArt%20Dataset/Genre/genre_val.csv

To create new embeddings using the code, you'll need the following libraries preferably gpu enables where possible:
Keras, tensorflow, sklearn, 

# Design

The embeddings are built using the keras VGG19 convolution network pretrained on the Imagenet dataset to extract two sets of features: one representing content (features are extracted from the last layer of the network), the other representing the style of the painting (features are extracted from the conv3_1 layer of the network). 
These sets features are normalised, weighted and combined before running the sklearn t-SNE over them. The output of this is used to train a neural network which can be used to generate t-SNE coordinates for any arbitrary image. Here's a summary diagram of the extraction process:

![Architecture Overview](https://raw.githubusercontent.com/michaeldowd2/Wikiart_tSNE/master/Images/Architecture_Summary.png)

## Qualitative Outputs
The embeddings are provided with different weights given to content and style. Here's a random sample from the wikiart dataset plotted using the provided t-SNE embeddings. Note the relatively nice clustering of similar paintings:

![Big tSNE Diagram](https://raw.githubusercontent.com/michaeldowd2/Wikiart_tSNE/master/Images/Real_Parametric_TSNE_Content100_Style100_Grid20x20.jpg)

A scatterplot of the resulting tSNE space grouped by the wikiart genre labels shows that the human labels aren't well aligned with the tSNE space, perhaps the tSNE embeddings are a better way to group historical art?

![Scatterplot of tSNE Space](https://raw.githubusercontent.com/michaeldowd2/Wikiart_tSNE/master/Images/tsne_space_scatterplot.jpg)

Check out the images folder for a few more examples as well as a comparison sample generated by the parametric t-SNE model

## Build your own Parametric t-SNE Model or Embeddings file
Creating the embeddings file or a parametric t-SNE model from scratch requires a few steps and preferably a cuda enabled GPU: 
1. The content feature representation file needs to be created - python ExtractContentFeatures.py
2. The style features file needs to be created, as well as the pca fit over the gramm matrix - python ExtractStyleFeatures.py
3. The t-SNE file can then be created from the above features - python CreateTSNEFeatures.py
4. A parametric t-SNE model can then be trained on the t-SNE embeddings - python LearnTSNE.py

## Resources and References
This project was inspired and informed by the following projects and papers:
- http://smedia.ust.hk/james/projects/deepart_ana.html
- https://cs.stanford.edu/people/karpathy/cnnembed/
- https://jeremiahwjohnsondotcom.wordpress.com
- https://lvdmaaten.github.io/publications/papers/AISTATS_2009.pdf

